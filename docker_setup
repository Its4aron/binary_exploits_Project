#!/usr/bin/env bash

echo HOME_MODE 0750 >>/etc/login.defs

seq 5 | while read i
do
    groupadd --system ch${i}flag
    useradd --shell=/bin/bash -m ch$i
    echo ch$i:123123 | chpasswd
    cp -Rv /root/challenges/ch$i /home/ch$i/challenge
    cp /root/flags/ch$i.txt /home/ch$i/challenge/flag.txt
    chown -Rv root /home/ch$i
    chown -Rv root:ch${i}flag /home/ch$i/challenge
    chmod 640 /home/ch$i/challenge/flag.txt
    chmod 2755 /home/ch$i/challenge/Challenge$i
done