#!/usr/bin/env bash

chown -Rv root:root /flags
chmod -Rv 640 /flags
chmod -v 755 /flags

seq 5 | while read i
do
    groupadd --system ch${i}flag
    useradd --shell=/bin/bash -m ch$i

    cp -Rv /root/challenges/ch$i /home/ch$i/challenge
    chown -Rv root:ch$i /home/ch$i
    chmod 750 /home/ch$i/challenge

    chown -v :ch${i}flag /home/ch$i/challenge/Challenge$i
    chmod 2755 /home/ch$i/challenge/Challenge$i

    chown -Rv :ch${i}flag /flags/ch$i.txt
    echo /welcome/ch${i}.txt >> /home/ch$i/.bashrc 
done

echo ch1:123123 | chpasswd
echo ch2:1337 | chpasswd
echo ch3:deadbeef | chpasswd
echo ch4:321321 | chpasswd
echo ch5:666 | chpasswd
